export const metadata = {
  title: "Domain + CNAME Setup",
  description: "Connect domains safely and enable locale serving.",
  section: "Basics",
  order: 2,
};

WebLingo serves translated pages at the edge while your source site remains unchanged on its
existing host.

## Recommended domain model

- Keep source content on the primary domain.
- Route localized traffic through subdomains (for example, `fr.example.com`).
- Map each locale to one serving target.

## Setup workflow

1. Verify ownership:
   - `POST /api/sites/{siteId}/domains/{domain}/verify` (`sites.domains.verify`)
2. Provision managed hostname (Cloudflare for SaaS accounts):
   - `POST /api/sites/{siteId}/domains/{domain}/provision` (`sites.domains.provision`)
3. Refresh validation/certificate status if needed:
   - `POST /api/sites/{siteId}/domains/{domain}/refresh` (`sites.domains.refresh`)
4. Enable locale serving:
   - `POST /api/sites/{siteId}/locales/{targetLang}/serve` (`sites.locales.serve`)

## Operational requirements (non-API)

- TXT verification: add the exact token value shown in the dashboard/API before activation.
- CNAME provisioning: for managed hostnames, point the locale host to the Cloudflare target and
  wait for certificate validation.
- DNS refresh checks: run dashboard/API refresh when DNS has propagated but status still shows
  pending.
- Activation guard: keep the site inactive until at least one domain is verified.

## Validation checklist

- DNS records resolve publicly.
- Domain status is verified in dashboard/API.
- TLS certificate status is healthy.
- Locale serving is enabled and deployment is active.
- `GET /{path}` returns localized content.

## Common rollout issues

- Domain stays pending:
  - re-check TXT/CNAME values and TTL.
- Certificate status lags:
  - call refresh endpoint and wait for propagation.
- Localized route returns source content:
  - ensure locale serving is enabled and a deployment exists.
- Localized route returns not found:
  - confirm the source page was crawled and published.

## Related docs

- [Getting Started](../getting-started)
- [Translation Pipeline](../translation-pipeline)
- [API Reference](../api-reference)
